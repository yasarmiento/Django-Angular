<div class="card-container m-2">
  <div class="card flex justify-content-center">

    <br>

    <button pButton (click)="showDialog()" icon="pi pi-plus" label="Subir Nuevo Archivo"
      class="p-button-primary m-2 p-button-outlined boton-redondo"></button>
    <br>
    <p-table [value]="archivos" [paginator]="true" [rows]="5" [rowsPerPageOptions]="[5, 10, 20]" class="p-datatable-striped custom-table">
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th>#</th>
          <th pSortableColumn="nombre_archivo_id">Tipo de Archivo <p-sortIcon field="nombre_archivo_id"></p-sortIcon>
          </th>
          <th pSortableColumn="archivo">Nombre del Archivo <p-sortIcon field="archivo"></p-sortIcon></th>
          <th pSortableColumn="proyectoid">Proyecto <p-sortIcon field="proyectoid"></p-sortIcon></th>
          <th>Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex">
        <tr>
          <td>{{ rowIndex + 1 }}</td>
          <td>{{ obtenerNombresArchivos(rowData.nombre_archivo_id) }}</td>
          <td class="file-cell">
            <a [href]="rowData.archivo" target="_blank" class="file-link">
              <span class="pi pi-file"></span> {{ getFileName(rowData.archivo) }}
            </a>
          </td>
          <td>{{ obtenerNombresProyectos(rowData.proyectoid) }}</td>
          <td>
            <button pButton type="button" label="Editar" icon="pi pi-pencil" class="p-button-warning p-button-outlined boton-redondo"
              (click)="editArchivo(rowData)"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>

  </div>
</div>

<!-- AGREGAR ARCHIVO -->

<p-dialog header="Agregar un Nuevo Archivo" [(visible)]="visible" [style]="{width: '50vw'}">
  <div>
    <div class="container">
      <form (ngSubmit)="saveArchivo()" #archivoForm="ngForm" enctype="multipart/form-data">

        <p-card header="Seleccione el documento relacionado:" [style]="{ width: '100%' }" class="m-2">
          <ng-template pTemplate="header">
          </ng-template>
          <p>
            <p-dropdown id="nombresArchivos" name="nombresArchivos" [(ngModel)]="archivosCrear.nombre_archivo_id"
              [options]="nombresArchivos" optionLabel="nombre_archivo" optionValue="id"
              placeholder="Seleccionar"></p-dropdown>
          </p>
          <ng-template pTemplate="footer">
            <!--<p-button label="Cancel" icon="pi pi-times" styleClass="p-button-secondary" [style]="{ 'margin-left': '.5em' }"></p-button>-->
          </ng-template>
        </p-card>

        <div class="form-group">
          <label for="archivo">Archivo:</label>
          <p-fileUpload name="archivo" (onSelect)="onFileSelect($event)" [maxFileSize]="1000000" [customUpload]="true">
          </p-fileUpload>
          <label>Archivo cargado: </label>
          <p>{{ archivoNombre }}</p>

        </div>

        <div class="form-group mt-2" style=" width: 100%">

          <p-card header="Seleccione proyecto al cual cargar el documento" [style]="{ width: '100%' }" class="m-2">
            <ng-template pTemplate="header">
            </ng-template>
            <p>
            </p>
            <p>
              <p-dropdown id="proyecto" name="proyecto" [(ngModel)]="archivosCrear.proyectoid" [options]="proyectos"
                optionLabel="proyecto" placeholder="Seleccionar" optionValue="id"></p-dropdown>
            </p>
            <ng-template pTemplate="footer">
              <!--<p-button label="Cancel" icon="pi pi-times" styleClass="p-button-secondary" [style]="{ 'margin-left': '.5em' }"></p-button>-->
            </ng-template>
          </p-card>
        </div>

        <button type="submit" pButton class="p-button-primary" label="Guardar"></button>
      </form>
    </div>
  </div>
</p-dialog>


<p-toast [style]="{ top: '80px'}"></p-toast>